var BC=function(k){var l=k.Matrix=k.Matrix||{};l.makeLookAt=function(a,b,g){b=BC.Math.normalize(BC.Math.subtractVectors(a,b));g=BC.Math.cross(g,b);var c=BC.Math.cross(b,g);return[g[0],g[1],g[2],0,c[0],c[1],c[2],0,b[0],b[1],b[2],0,a[0],a[1],a[2],1]};l.makePerspective=function(a,b,g,c){a=Math.tan(0.5*Math.PI-0.5*a);var d=1/(g-c);return[a/b,0,0,0,0,a,0,0,0,0,(g+c)*d,-1,0,0,g*c*d*2,0]};l.makeTranslation=function(a,b,g){return[1,0,0,0,0,1,0,0,0,0,1,0,a,b,g,1]};l.makeXRotation=function(a){var b=Math.cos(a);
a=Math.sin(a);return[1,0,0,0,0,b,a,0,0,-a,b,0,0,0,0,1]};l.makeYRotation=function(a){var b=Math.cos(a);a=Math.sin(a);return[b,0,-a,0,0,1,0,0,a,0,b,0,0,0,0,1]};l.makeZRotation=function(a){var b=Math.cos(a);a=Math.sin(a);return[b,a,0,0,-a,b,0,0,0,0,1,0,0,0,0,1]};l.makeScale=function(a,b,g){return[a,0,0,0,0,b,0,0,0,0,g,0,0,0,0,1]};l.makeInverse=function(a){var b=a[0],g=a[1],c=a[2],d=a[3],h=a[4],p=a[5],l=a[6],k=a[7],u=a[8],q=a[9],A=a[10],B=a[11],y=a[12],s=a[13],v=a[14];a=a[15];var r=A*a,t=v*B,f=l*a,z=
v*k,C=l*B,w=A*k,D=c*a,E=v*d,F=c*B,e=A*d,m=c*k,n=l*d,x=u*s,H=y*q,I=h*s,G=y*p,J=h*q,K=u*p,L=b*s,M=y*g,N=b*q,O=u*g,P=b*p,Q=h*g,S=r*p+z*q+C*s-(t*p+f*q+w*s),T=t*g+D*q+e*s-(r*g+E*q+F*s),s=f*g+E*p+m*s-(z*g+D*p+n*s),g=w*g+F*p+n*q-(C*g+e*p+m*q),p=1/(b*S+h*T+u*s+y*g);return[p*S,p*T,p*s,p*g,p*(t*h+f*u+w*y-(r*h+z*u+C*y)),p*(r*b+E*u+F*y-(t*b+D*u+e*y)),p*(z*b+D*h+n*y-(f*b+E*h+m*y)),p*(C*b+e*h+m*u-(w*b+F*h+n*u)),p*(x*k+G*B+J*a-(H*k+I*B+K*a)),p*(H*d+L*B+O*a-(x*d+M*B+N*a)),p*(I*d+M*k+P*a-(G*d+L*k+Q*a)),p*(K*d+N*k+
Q*B-(J*d+O*k+P*B)),p*(I*A+K*v+H*l-(J*v+x*l+G*A)),p*(N*v+x*c+M*A-(L*A+O*v+H*c)),p*(L*l+Q*v+G*c-(P*v+I*c+M*l)),p*(P*A+J*c+O*l-(N*l+Q*A+K*c))]};l.matrixMultiply=function(a,b){return[a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+a[3]*b[12],a[0]*b[1]+a[1]*b[5]+a[2]*b[9]+a[3]*b[13],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]+a[3]*b[14],a[0]*b[3]+a[1]*b[7]+a[2]*b[11]+a[3]*b[15],a[4]*b[0]+a[5]*b[4]+a[6]*b[8]+a[7]*b[12],a[4]*b[1]+a[5]*b[5]+a[6]*b[9]+a[7]*b[13],a[4]*b[2]+a[5]*b[6]+a[6]*b[10]+a[7]*b[14],a[4]*b[3]+a[5]*b[7]+a[6]*b[11]+a[7]*
b[15],a[8]*b[0]+a[9]*b[4]+a[10]*b[8]+a[11]*b[12],a[8]*b[1]+a[9]*b[5]+a[10]*b[9]+a[11]*b[13],a[8]*b[2]+a[9]*b[6]+a[10]*b[10]+a[11]*b[14],a[8]*b[3]+a[9]*b[7]+a[10]*b[11]+a[11]*b[15],a[12]*b[0]+a[13]*b[4]+a[14]*b[8]+a[15]*b[12],a[12]*b[1]+a[13]*b[5]+a[14]*b[9]+a[15]*b[13],a[12]*b[2]+a[13]*b[6]+a[14]*b[10]+a[15]*b[14],a[12]*b[3]+a[13]*b[7]+a[14]*b[11]+a[15]*b[15]]};return k}(BC||{});BC=function(k){(k.Time=k.Time||{}).getTimeInSeconds=function(){return 0.001*Date.now()};return k}(BC||{});BC=function(k){var l=k.GL=k.GL||{};l.loadShader=function(a,b,g,c){c=c||BC.Util.error;var d=document.getElementById(b);if(!d)return c("** Error getting script element:"+b),null;b=a.createShader(g);a.shaderSource(b,d.text);a.compileShader(b);return a.getShaderParameter(b,a.COMPILE_STATUS)?b:(lastError=a.getShaderInfoLog(b),c("*** Error compiling shader '"+b+"':"+lastError),a.deleteShader(b),null)};l.createProgram=function(a,b,g,c){for(var d=a.createProgram(),h=0;h<b.length;h++)a.attachShader(d,b[h]);
if(g)for(h=0;h<g.length;h++)a.bindAttribLocation(d,c?c[h]:h,g[h]);a.linkProgram(d);return a.getProgramParameter(d,a.LINK_STATUS)?d:(lastError=a.getProgramInfoLog(d),error("Error in program linking: "+lastError),a.deleteProgram(d),null)};l.textureTileSet=function(a,b,g){var c=1/a,d=1/b;return{tile:function(a,b){var l=c*b,k=d*a;return{textureCoord:function(a,b){return[l+g+(c-2*g)*a,k+g+(d-2*g)*b]}}}}};return k}(BC||{});BC=function(k){(k.Game=k.Game||{}).run=function(){function l(){return g.width!=g.clientWidth||g.height!=g.clientHeight?(g.width=g.clientWidth,g.height=g.clientHeight,!0):!1}function a(){var a=g.width/g.height,b=BC.Math.radians(55);return BC.Matrix.makePerspective(b,a,1,2E3)}function b(){c.viewport(0,0,c.canvas.width,c.canvas.height);var a=BC.Time.getTimeInSeconds(),e=a-u;u=a;q[0]+=r[0]*e;q[1]+=r[1]*e;var d=BC.Matrix.makeZRotation(q[2]),a=BC.Matrix.makeYRotation(q[1]),e=BC.Matrix.makeXRotation(q[0]),
d=BC.Matrix.matrixMultiply(A,d),d=BC.Matrix.matrixMultiply(d,a),d=BC.Matrix.matrixMultiply(d,e),d=BC.Matrix.matrixMultiply(d,B),d=BC.Matrix.matrixMultiply(d,y),d=BC.Matrix.matrixMultiply(d,G),a=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,a);c.bufferData(c.ARRAY_BUFFER,H,c.STATIC_DRAW);c.enableVertexAttribArray(k);c.vertexAttribPointer(k,3,c.FLOAT,!1,0,0);c.uniformMatrix4fv(U,!1,d);a=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,a);c.enableVertexAttribArray(R);c.vertexAttribPointer(R,2,c.FLOAT,!1,
0,0);c.bufferData(c.ARRAY_BUFFER,I,c.STATIC_DRAW);c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT);c.drawArrays(c.TRIANGLES,0,f.length/3);requestAnimationFrame(b)}var g=document.getElementById("canvas");if(g){var c=g.getContext("webgl")||g.getContext("experimental-webgl");if(c){c.enable(c.CULL_FACE);c.enable(c.DEPTH_TEST);var d=BC.GL.loadShader(c,"vertex-shader",c.VERTEX_SHADER),h=BC.GL.loadShader(c,"fragment-shader",c.FRAGMENT_SHADER),d=BC.GL.createProgram(c,[d,h]);c.useProgram(d);var k=c.getAttribLocation(d,
"a_position"),R=c.getAttribLocation(d,"a_texcoord"),U=c.getUniformLocation(d,"u_matrix"),u=BC.Time.getTimeInSeconds(),q=[BC.Math.radians(0),BC.Math.radians(0),BC.Math.radians(0)],d=[1,1,1],A=BC.Matrix.makeScale(d[0],d[1],d[2]),d=[0,0,0],B=BC.Matrix.makeTranslation(d[0],d[1],d[2]),d=BC.Matrix.makeLookAt([0,0.75,2],[0,0,0],[0,1,0]),y=BC.Matrix.makeInverse(d),s=c.createTexture();c.bindTexture(c.TEXTURE_2D,s);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,1,1,0,c.RGBA,c.UNSIGNED_BYTE,new Uint8Array([255,0,0,255]));
var v=new Image;v.src="images/block-texture.png";$(v).load(function(){c.bindTexture(c.TEXTURE_2D,s);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,v);c.generateMipmap(c.TEXTURE_2D)});var r=[0,0,0];$(document).keydown(function(a){switch(a.keyCode){case 32:r[0]=0;r[1]=0;break;case 37:r[0]=0;r[1]=-1;break;case 38:r[0]=-1;r[1]=0;break;case 39:r[0]=0;r[1]=1;break;case 40:r[0]=1,r[1]=0}});for(var d=BC.Math.circlePoints(0.75,24),h=BC.Math.circlePoints(1,24),t=BC.GL.textureTileSet(4,4,0.01),t=
[t.tile(0,0),t.tile(0,1),t.tile(0,2),t.tile(0,3),t.tile(1,0),t.tile(1,1)],f=[],z=[],C=0,w=function(a,b,c,d,e,f,g){b=a.textureCoord(b,c);z[C++]=b[0];z[C++]=b[1];b=a.textureCoord(d,e);z[C++]=b[0];z[C++]=b[1];b=a.textureCoord(f,g);z[C++]=b[0];z[C++]=b[1]},D=0,E=0,F=0,e=0,m=0;24>F;F++,m+=2){for(var n=(m+2)%h.length;E===D;)D=Math.floor(Math.random()*t.length);var E=D,x=t[D];f[e++]=d[m];f[e++]=0.15;f[e++]=-d[m+1];f[e++]=h[m];f[e++]=0.15;f[e++]=-h[m+1];f[e++]=h[n];f[e++]=0.15;f[e++]=-h[n+1];w(x,0,0,0,1,
1,1);f[e++]=d[m];f[e++]=0.15;f[e++]=-d[m+1];f[e++]=h[n];f[e++]=0.15;f[e++]=-h[n+1];f[e++]=d[n];f[e++]=0.15;f[e++]=-d[n+1];w(x,0,0,1,1,1,0);f[e++]=d[m];f[e++]=-0.15;f[e++]=-d[m+1];f[e++]=h[n];f[e++]=-0.15;f[e++]=-h[n+1];f[e++]=h[m];f[e++]=-0.15;f[e++]=-h[m+1];w(x,0,0,1,1,0,1);f[e++]=d[m];f[e++]=-0.15;f[e++]=-d[m+1];f[e++]=d[n];f[e++]=-0.15;f[e++]=-d[n+1];f[e++]=h[n];f[e++]=-0.15;f[e++]=-h[n+1];w(x,0,0,1,0,1,1);f[e++]=h[m];f[e++]=-0.15;f[e++]=-h[m+1];f[e++]=h[n];f[e++]=-0.15;f[e++]=-h[n+1];f[e++]=h[n];
f[e++]=0.15;f[e++]=-h[n+1];w(x,0,1,1,1,1,0);f[e++]=h[m];f[e++]=-0.15;f[e++]=-h[m+1];f[e++]=h[n];f[e++]=0.15;f[e++]=-h[n+1];f[e++]=h[m];f[e++]=0.15;f[e++]=-h[m+1];w(x,0,1,1,0,0,0);f[e++]=d[m];f[e++]=-0.15;f[e++]=-d[m+1];f[e++]=d[n];f[e++]=0.15;f[e++]=-d[n+1];f[e++]=d[n];f[e++]=-0.15;f[e++]=-d[n+1];w(x,0,1,1,0,1,1);f[e++]=d[m];f[e++]=-0.15;f[e++]=-d[m+1];f[e++]=d[m];f[e++]=0.15;f[e++]=-d[m+1];f[e++]=d[n];f[e++]=0.15;f[e++]=-d[n+1];w(x,0,1,0,0,1,0)}var H=new Float32Array(f),I=new Float32Array(z);l();
var G=a();$(window).resize(function(){l()&&(G=a())});b()}}};return k}(BC||{});$(document).ready(function(){BC.Game.run()});BC=function(k){var l=k.Math=k.Math||{};l.radians=function(a){return a*Math.PI/180};l.circlePoints=function(a,b){for(var g=2*Math.PI/b,c=[],d=0;d<b;d++)c[2*d]=a*Math.cos(d*g),c[2*d+1]=a*Math.sin(d*g);return c};l.cross=function(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]};l.subtractVectors=function(a,b){return[a[0]-b[0],a[1]-b[1],a[2]-b[2]]};l.normalize=function(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return 1E-5<b?[a[0]/b,a[1]/b,a[2]/b]:[0,0,0]};return k}(BC||
{});BC=function(k){(k.Util=k.Util||{}).error=function(k){window.console&&(window.console.error?window.console.error(k):window.console.log&&window.console.log(k))};return k}(BC||{});
