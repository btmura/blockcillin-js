var BC={};BC.Game=function(){return{run:function(){function a(){function a(){var b=BC.Time.getTimeInSeconds(),d=b-m;m=b;h[0]+=k[0]*d;h[1]+=k[1]*d;var e=BC.Matrix.makeZRotation(h[2]),b=BC.Matrix.makeYRotation(h[1]),d=BC.Matrix.makeXRotation(h[0]),e=BC.Matrix.matrixMultiply(s,e),e=BC.Matrix.matrixMultiply(e,b),e=BC.Matrix.matrixMultiply(e,d),e=BC.Matrix.matrixMultiply(e,n),e=BC.Matrix.matrixMultiply(e,l),e=BC.Matrix.matrixMultiply(e,w),b=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,b);c.bufferData(c.ARRAY_BUFFER,
new Float32Array([-1,1,1,-1,-1,1,1,-1,1,-1,1,1,1,-1,1,1,1,1,1,1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,1,-1,-1,-1,-1,1,1,-1,-1,1,-1,1]),c.STATIC_DRAW);c.enableVertexAttribArray(p);c.vertexAttribPointer(p,3,c.FLOAT,!1,0,0);c.uniformMatrix4fv(q,!1,e);b=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,b);c.enableVertexAttribArray(r);c.vertexAttribPointer(r,
2,c.FLOAT,!1,0,0);c.bufferData(c.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0,0,1,1,0,0,0,0,1,1,1,1,0,1,0,0,1,1,1,1,0,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,0,1,0,0,1,0,0,1,1,0,1,1]),c.STATIC_DRAW);c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT);c.drawArrays(c.TRIANGLES,0,36);requestAnimationFrame(a)}var d=BC.GL.createProgram(c,[e,f]);c.useProgram(d);var p=c.getAttribLocation(d,"a_position"),r=c.getAttribLocation(d,"a_texcoord"),q=c.getUniformLocation(d,"u_matrix"),m=BC.Time.getTimeInSeconds(),
h=[BC.Math.radians(0),BC.Math.radians(0),BC.Math.radians(0)],d=[1,1,1],s=BC.Matrix.makeScale(d[0],d[1],d[2]),d=[0,0,0],n=BC.Matrix.makeTranslation(d[0],d[1],d[2]),d=BC.Matrix.makeLookAt([0,5,5],[0,0,0],[0,1,0]),l=BC.Matrix.makeInverse(d),d=b.width/b.height,t=BC.Math.radians(55),w=BC.Matrix.makePerspective(t,d,1,2E3),v=c.createTexture();c.bindTexture(c.TEXTURE_2D,v);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,1,1,0,c.RGBA,c.UNSIGNED_BYTE,new Uint8Array([0,0,255,255]));var u=new Image;u.src="images/texture.png";
u.addEventListener("load",function(){c.bindTexture(c.TEXTURE_2D,v);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,u);c.generateMipmap(c.TEXTURE_2D)});var k=[0,0,0];$(document).keydown(function(a){switch(a.keyCode){case 32:k[0]=0;k[1]=0;break;case 37:k[0]=0;k[1]=-1;break;case 38:k[0]=-1;k[1]=0;break;case 39:k[0]=0;k[1]=1;break;case 40:k[0]=1,k[1]=0}});a()}var b=document.getElementById("canvas");if(b){var c=b.getContext("webgl")||b.getContext("experimental-webgl");if(c){c.enable(c.CULL_FACE);
c.enable(c.DEPTH_TEST);var e,f;$.when($.get("/shaders/vertex.glsl",function(a){e=BC.GL.loadShader(c,a,c.VERTEX_SHADER)}),$.get("/shaders/fragment.glsl",function(a){f=BC.GL.loadShader(c,a,c.FRAGMENT_SHADER)})).then(a)}}}}}();BC.GL=function(){return{loadShader:function(a,b,c,e){e=e||BC.Util.error;c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return a.getShaderParameter(c,a.COMPILE_STATUS)?c:(lastError=a.getShaderInfoLog(c),e("*** Error compiling shader '"+c+"':"+lastError),a.deleteShader(c),null)},createProgram:function(a,b,c,e){for(var f=a.createProgram(),g=0;g<b.length;g++)a.attachShader(f,b[g]);if(c)for(g=0;g<c.length;g++)a.bindAttribLocation(f,e?e[g]:g,c[g]);a.linkProgram(f);return a.getProgramParameter(f,
a.LINK_STATUS)?f:(lastError=a.getProgramInfoLog(f),error("Error in program linking: "+lastError),a.deleteProgram(f),null)}}}();BC.Math=function(){return{radians:function(a){return a*Math.PI/180},cross:function(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]},subtractVectors:function(a,b){return[a[0]-b[0],a[1]-b[1],a[2]-b[2]]},normalize:function(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return 1E-5<b?[a[0]/b,a[1]/b,a[2]/b]:[0,0,0]}}}();BC.Matrix=function(){return{makeLookAt:function(a,b,c){b=BC.Math.normalize(BC.Math.subtractVectors(a,b));c=BC.Math.cross(c,b);var e=BC.Math.cross(b,c);return[c[0],c[1],c[2],0,e[0],e[1],e[2],0,b[0],b[1],b[2],0,a[0],a[1],a[2],1]},makePerspective:function(a,b,c,e){a=Math.tan(0.5*Math.PI-0.5*a);var f=1/(c-e);return[a/b,0,0,0,0,a,0,0,0,0,(c+e)*f,-1,0,0,c*e*f*2,0]},makeTranslation:function(a,b,c){return[1,0,0,0,0,1,0,0,0,0,1,0,a,b,c,1]},makeXRotation:function(a){var b=Math.cos(a);a=Math.sin(a);return[1,
0,0,0,0,b,a,0,0,-a,b,0,0,0,0,1]},makeYRotation:function(a){var b=Math.cos(a);a=Math.sin(a);return[b,0,-a,0,0,1,0,0,a,0,b,0,0,0,0,1]},makeZRotation:function(a){var b=Math.cos(a);a=Math.sin(a);return[b,a,0,0,-a,b,0,0,0,0,1,0,0,0,0,1]},makeScale:function(a,b,c){return[a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1]},makeInverse:function(a){var b=a[0],c=a[1],e=a[2],f=a[3],g=a[4],d=a[5],p=a[6],r=a[7],q=a[8],m=a[9],h=a[10],s=a[11],n=a[12],l=a[13],t=a[14];a=a[15];var w=h*a,v=t*s,u=p*a,k=t*r,x=p*s,y=h*r,z=e*a,A=t*f,B=e*
s,C=h*f,D=e*r,E=p*f,F=q*l,G=n*m,H=g*l,I=n*d,J=g*m,K=q*d,L=b*l,M=n*c,N=b*m,O=q*c,P=b*d,Q=g*c,R=w*d+k*m+x*l-(v*d+u*m+y*l),S=v*c+z*m+C*l-(w*c+A*m+B*l),l=u*c+A*d+D*l-(k*c+z*d+E*l),c=y*c+B*d+E*m-(x*c+C*d+D*m),d=1/(b*R+g*S+q*l+n*c);return[d*R,d*S,d*l,d*c,d*(v*g+u*q+y*n-(w*g+k*q+x*n)),d*(w*b+A*q+B*n-(v*b+z*q+C*n)),d*(k*b+z*g+E*n-(u*b+A*g+D*n)),d*(x*b+C*g+D*q-(y*b+B*g+E*q)),d*(F*r+I*s+J*a-(G*r+H*s+K*a)),d*(G*f+L*s+O*a-(F*f+M*s+N*a)),d*(H*f+M*r+P*a-(I*f+L*r+Q*a)),d*(K*f+N*r+Q*s-(J*f+O*r+P*s)),d*(H*h+K*t+G*
p-(J*t+F*p+I*h)),d*(N*t+F*e+M*h-(L*h+O*t+G*e)),d*(L*p+Q*t+I*e-(P*t+H*e+M*p)),d*(P*h+J*e+O*p-(N*p+Q*h+K*e))]},matrixMultiply:function(a,b){return[a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+a[3]*b[12],a[0]*b[1]+a[1]*b[5]+a[2]*b[9]+a[3]*b[13],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]+a[3]*b[14],a[0]*b[3]+a[1]*b[7]+a[2]*b[11]+a[3]*b[15],a[4]*b[0]+a[5]*b[4]+a[6]*b[8]+a[7]*b[12],a[4]*b[1]+a[5]*b[5]+a[6]*b[9]+a[7]*b[13],a[4]*b[2]+a[5]*b[6]+a[6]*b[10]+a[7]*b[14],a[4]*b[3]+a[5]*b[7]+a[6]*b[11]+a[7]*b[15],a[8]*b[0]+a[9]*b[4]+a[10]*
b[8]+a[11]*b[12],a[8]*b[1]+a[9]*b[5]+a[10]*b[9]+a[11]*b[13],a[8]*b[2]+a[9]*b[6]+a[10]*b[10]+a[11]*b[14],a[8]*b[3]+a[9]*b[7]+a[10]*b[11]+a[11]*b[15],a[12]*b[0]+a[13]*b[4]+a[14]*b[8]+a[15]*b[12],a[12]*b[1]+a[13]*b[5]+a[14]*b[9]+a[15]*b[13],a[12]*b[2]+a[13]*b[6]+a[14]*b[10]+a[15]*b[14],a[12]*b[3]+a[13]*b[7]+a[14]*b[11]+a[15]*b[15]]}}}();$(document).ready(function(){BC.Game.run()});BC.Time=function(){return{getTimeInSeconds:function(){return 0.001*Date.now()}}}();BC.Util=function(){return{error:function(a){window.console&&(window.console.error?window.console.error(a):window.console.log&&window.console.log(a))}}}();
