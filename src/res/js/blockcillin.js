var BC=function(d){var e=d.Matrix=d.Matrix||{};e.makeLookAt=function(a,b,c){b=BC.Math.normalize(BC.Math.subtractVectors(a,b));c=BC.Math.cross(c,b);var h=BC.Math.cross(b,c);return[c[0],c[1],c[2],0,h[0],h[1],h[2],0,b[0],b[1],b[2],0,a[0],a[1],a[2],1]};e.makePerspective=function(a,b,c,h){a=Math.tan(0.5*Math.PI-0.5*a);var p=1/(c-h);return[a/b,0,0,0,0,a,0,0,0,0,(c+h)*p,-1,0,0,c*h*p*2,0]};e.makeTranslation=function(a,b,c){return[1,0,0,0,0,1,0,0,0,0,1,0,a,b,c,1]};e.makeXRotation=function(a){var b=Math.cos(a);
a=Math.sin(a);return[1,0,0,0,0,b,a,0,0,-a,b,0,0,0,0,1]};e.makeYRotation=function(a){var b=Math.cos(a);a=Math.sin(a);return[b,0,-a,0,0,1,0,0,a,0,b,0,0,0,0,1]};e.makeZRotation=function(a){var b=Math.cos(a);a=Math.sin(a);return[b,a,0,0,-a,b,0,0,0,0,1,0,0,0,0,1]};e.makeScale=function(a,b,c){return[a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1]};e.makeInverse=function(a){var b=a[0],c=a[1],h=a[2],p=a[3],f=a[4],g=a[5],d=a[6],e=a[7],n=a[8],k=a[9],r=a[10],s=a[11],q=a[12],m=a[13],t=a[14];a=a[15];var v=r*a,u=t*s,l=d*a,w=
t*e,x=d*s,y=r*e,z=h*a,A=t*p,B=h*s,C=r*p,D=h*e,E=d*p,F=n*m,G=q*k,H=f*m,I=q*g,J=f*k,K=n*g,L=b*m,M=q*c,N=b*k,O=n*c,P=b*g,Q=f*c,S=v*g+w*k+x*m-(u*g+l*k+y*m),T=u*c+z*k+C*m-(v*c+A*k+B*m),m=l*c+A*g+D*m-(w*c+z*g+E*m),c=y*c+B*g+E*k-(x*c+C*g+D*k),g=1/(b*S+f*T+n*m+q*c);return[g*S,g*T,g*m,g*c,g*(u*f+l*n+y*q-(v*f+w*n+x*q)),g*(v*b+A*n+B*q-(u*b+z*n+C*q)),g*(w*b+z*f+E*q-(l*b+A*f+D*q)),g*(x*b+C*f+D*n-(y*b+B*f+E*n)),g*(F*e+I*s+J*a-(G*e+H*s+K*a)),g*(G*p+L*s+O*a-(F*p+M*s+N*a)),g*(H*p+M*e+P*a-(I*p+L*e+Q*a)),g*(K*p+N*e+
Q*s-(J*p+O*e+P*s)),g*(H*r+K*t+G*d-(J*t+F*d+I*r)),g*(N*t+F*h+M*r-(L*r+O*t+G*h)),g*(L*d+Q*t+I*h-(P*t+H*h+M*d)),g*(P*r+J*h+O*d-(N*d+Q*r+K*h))]};e.matrixMultiply=function(a,b){return[a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+a[3]*b[12],a[0]*b[1]+a[1]*b[5]+a[2]*b[9]+a[3]*b[13],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]+a[3]*b[14],a[0]*b[3]+a[1]*b[7]+a[2]*b[11]+a[3]*b[15],a[4]*b[0]+a[5]*b[4]+a[6]*b[8]+a[7]*b[12],a[4]*b[1]+a[5]*b[5]+a[6]*b[9]+a[7]*b[13],a[4]*b[2]+a[5]*b[6]+a[6]*b[10]+a[7]*b[14],a[4]*b[3]+a[5]*b[7]+a[6]*b[11]+a[7]*
b[15],a[8]*b[0]+a[9]*b[4]+a[10]*b[8]+a[11]*b[12],a[8]*b[1]+a[9]*b[5]+a[10]*b[9]+a[11]*b[13],a[8]*b[2]+a[9]*b[6]+a[10]*b[10]+a[11]*b[14],a[8]*b[3]+a[9]*b[7]+a[10]*b[11]+a[11]*b[15],a[12]*b[0]+a[13]*b[4]+a[14]*b[8]+a[15]*b[12],a[12]*b[1]+a[13]*b[5]+a[14]*b[9]+a[15]*b[13],a[12]*b[2]+a[13]*b[6]+a[14]*b[10]+a[15]*b[14],a[12]*b[3]+a[13]*b[7]+a[14]*b[11]+a[15]*b[15]]};return d}(BC||{});$(document).ready(function(){BC.Game.run()});BC=function(d){(d.Time=d.Time||{}).getTimeInSeconds=function(){return 0.001*Date.now()};return d}(BC||{});BC=function(d){(d.Util=d.Util||{}).error=function(d){window.console&&(window.console.error?window.console.error(d):window.console.log&&window.console.log(d))};return d}(BC||{});BC=function(d){var e=d.GL=d.GL||{};e.loadShader=function(a,b,c,d){d=d||BC.Util.error;c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return a.getShaderParameter(c,a.COMPILE_STATUS)?c:(lastError=a.getShaderInfoLog(c),d("*** Error compiling shader '"+c+"':"+lastError),a.deleteShader(c),null)};e.createProgram=function(a,b,c,d){for(var e=a.createProgram(),f=0;f<b.length;f++)a.attachShader(e,b[f]);if(c)for(f=0;f<c.length;f++)a.bindAttribLocation(e,d?d[f]:f,c[f]);a.linkProgram(e);return a.getProgramParameter(e,
a.LINK_STATUS)?e:(lastError=a.getProgramInfoLog(e),error("Error in program linking: "+lastError),a.deleteProgram(e),null)};return d}(BC||{});BC=function(d){(d.Game=d.Game||{}).run=function(){function d(){function e(){var a=BC.Time.getTimeInSeconds(),d=a-n;n=a;k[0]+=l[0]*d;k[1]+=l[1]*d;var c=BC.Matrix.makeZRotation(k[2]),a=BC.Matrix.makeYRotation(k[1]),d=BC.Matrix.makeXRotation(k[0]),c=BC.Matrix.matrixMultiply(r,c),c=BC.Matrix.matrixMultiply(c,a),c=BC.Matrix.matrixMultiply(c,d),c=BC.Matrix.matrixMultiply(c,s),c=BC.Matrix.matrixMultiply(c,q),c=BC.Matrix.matrixMultiply(c,t),a=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,a);b.bufferData(b.ARRAY_BUFFER,
new Float32Array([-1,1,1,-1,-1,1,1,-1,1,-1,1,1,1,-1,1,1,1,1,1,1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,1,-1,-1,-1,-1,1,1,-1,-1,1,-1,1]),b.STATIC_DRAW);b.enableVertexAttribArray(g);b.vertexAttribPointer(g,3,b.FLOAT,!1,0,0);b.uniformMatrix4fv(U,!1,c);a=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,a);b.enableVertexAttribArray(R);b.vertexAttribPointer(R,
2,b.FLOAT,!1,0,0);b.bufferData(b.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0,0,1,1,0,0,0,0,1,1,1,1,0,1,0,0,1,1,1,1,0,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,0,1,0,0,1,0,0,1,1,0,1,1]),b.STATIC_DRAW);b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT);b.drawArrays(b.TRIANGLES,0,36);requestAnimationFrame(e)}var f=BC.GL.createProgram(b,[c,h]);b.useProgram(f);var g=b.getAttribLocation(f,"a_position"),R=b.getAttribLocation(f,"a_texcoord"),U=b.getUniformLocation(f,"u_matrix"),n=BC.Time.getTimeInSeconds(),
k=[BC.Math.radians(0),BC.Math.radians(0),BC.Math.radians(0)],f=[1,1,1],r=BC.Matrix.makeScale(f[0],f[1],f[2]),f=[0,0,0],s=BC.Matrix.makeTranslation(f[0],f[1],f[2]),f=BC.Matrix.makeLookAt([0,5,5],[0,0,0],[0,1,0]),q=BC.Matrix.makeInverse(f),f=a.width/a.height,m=BC.Math.radians(55),t=BC.Matrix.makePerspective(m,f,1,2E3),v=b.createTexture();b.bindTexture(b.TEXTURE_2D,v);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,1,1,0,b.RGBA,b.UNSIGNED_BYTE,new Uint8Array([0,0,255,255]));var u=new Image;u.src="images/texture.png";
u.addEventListener("load",function(){b.bindTexture(b.TEXTURE_2D,v);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,u);b.generateMipmap(b.TEXTURE_2D)});var l=[0,0,0];$(document).keydown(function(a){switch(a.keyCode){case 32:l[0]=0;l[1]=0;break;case 37:l[0]=0;l[1]=-1;break;case 38:l[0]=-1;l[1]=0;break;case 39:l[0]=0;l[1]=1;break;case 40:l[0]=1,l[1]=0}});e()}var a=document.getElementById("canvas");if(a){var b=a.getContext("webgl")||a.getContext("experimental-webgl");if(b){b.enable(b.CULL_FACE);
b.enable(b.DEPTH_TEST);var c,h;$.when($.get("/shaders/vertex.glsl",function(a){c=BC.GL.loadShader(b,a,b.VERTEX_SHADER)}),$.get("/shaders/fragment.glsl",function(a){h=BC.GL.loadShader(b,a,b.FRAGMENT_SHADER)})).then(d)}}};return d}(BC||{});BC=function(d){var e=d.Math=d.Math||{};e.radians=function(a){return a*Math.PI/180};e.cross=function(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]};e.subtractVectors=function(a,b){return[a[0]-b[0],a[1]-b[1],a[2]-b[2]]};e.normalize=function(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return 1E-5<b?[a[0]/b,a[1]/b,a[2]/b]:[0,0,0]};return d}(BC||{});
