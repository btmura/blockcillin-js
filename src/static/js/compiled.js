function makePerspective(a,b,c,f){a=Math.tan(0.5*Math.PI-0.5*a);var d=1/(c-f);return[a/b,0,0,0,0,a,0,0,0,0,(c+f)*d,-1,0,0,c*f*d*2,0]}function makeTranslation(a,b,c){return[1,0,0,0,0,1,0,0,0,0,1,0,a,b,c,1]}function makeXRotation(a){var b=Math.cos(a);a=Math.sin(a);return[1,0,0,0,0,b,a,0,0,-a,b,0,0,0,0,1]}function makeYRotation(a){var b=Math.cos(a);a=Math.sin(a);return[b,0,-a,0,0,1,0,0,a,0,b,0,0,0,0,1]}
function makeZRotation(a){var b=Math.cos(a);a=Math.sin(a);return[b,a,0,0,-a,b,0,0,0,0,1,0,0,0,0,1]}function makeScale(a,b,c){return[a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1]}
function matrixMultiply(a,b){return[a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+a[3]*b[12],a[0]*b[1]+a[1]*b[5]+a[2]*b[9]+a[3]*b[13],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]+a[3]*b[14],a[0]*b[3]+a[1]*b[7]+a[2]*b[11]+a[3]*b[15],a[4]*b[0]+a[5]*b[4]+a[6]*b[8]+a[7]*b[12],a[4]*b[1]+a[5]*b[5]+a[6]*b[9]+a[7]*b[13],a[4]*b[2]+a[5]*b[6]+a[6]*b[10]+a[7]*b[14],a[4]*b[3]+a[5]*b[7]+a[6]*b[11]+a[7]*b[15],a[8]*b[0]+a[9]*b[4]+a[10]*b[8]+a[11]*b[12],a[8]*b[1]+a[9]*b[5]+a[10]*b[9]+a[11]*b[13],a[8]*b[2]+a[9]*b[6]+a[10]*b[10]+a[11]*b[14],a[8]*
b[3]+a[9]*b[7]+a[10]*b[11]+a[11]*b[15],a[12]*b[0]+a[13]*b[4]+a[14]*b[8]+a[15]*b[12],a[12]*b[1]+a[13]*b[5]+a[14]*b[9]+a[15]*b[13],a[12]*b[2]+a[13]*b[6]+a[14]*b[10]+a[15]*b[14],a[12]*b[3]+a[13]*b[7]+a[14]*b[11]+a[15]*b[15]]};var error=function(a){window.console&&(window.console.error?window.console.error(a):window.console.log&&window.console.log(a))},loadShader=function(a,b,c,f){f=f||error;c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return a.getShaderParameter(c,a.COMPILE_STATUS)?c:(lastError=a.getShaderInfoLog(c),f("*** Error compiling shader '"+c+"':"+lastError),a.deleteShader(c),null)},createProgram=function(a,b,c,f){for(var d=a.createProgram(),e=0;e<b.length;e++)a.attachShader(d,b[e]);if(c)for(e=0;e<
c.length;e++)a.bindAttribLocation(d,f?f[e]:e,c[e]);a.linkProgram(d);return a.getProgramParameter(d,a.LINK_STATUS)?d:(lastError=a.getProgramInfoLog(d),error("Error in program linking: "+lastError),a.deleteProgram(d),null)};
$(document).ready(function(){var a=document.getElementById("canvas"),b=a.getContext("webgl")||a.getContext("experimental-webgl"),c,f;$.when($.get("/glsl/vertex.glsl",function(a){c=loadShader(b,a,b.VERTEX_SHADER)}),$.get("/glsl/fragment.glsl",function(a){f=loadShader(b,a,b.FRAGMENT_SHADER)})).then(function(){var d=createProgram(b,[c,f]);b.useProgram(d);var e=b.getAttribLocation(d,"a_position"),m=b.getAttribLocation(d,"a_color"),d=b.getUniformLocation(d,"u_matrix"),k=[0,0,-5],l=[45*Math.PI/180,-45*
Math.PI/180,0*Math.PI/180],h=[1,1,1],g=makeScale(h[0],h[1],h[2]),n=makeZRotation(l[2]),h=makeYRotation(l[1]),l=makeXRotation(l[0]),k=makeTranslation(k[0],k[1],k[2]),p=makePerspective(55*Math.PI/180,a.width/a.height,1,2E3),g=matrixMultiply(g,n),g=matrixMultiply(g,h),g=matrixMultiply(g,l),g=matrixMultiply(g,k),g=matrixMultiply(g,p),h=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,h);b.bufferData(b.ARRAY_BUFFER,new Float32Array([-1,1,1,1,-1,1,-1,-1,1,-1,1,1,1,1,1,1,-1,1,1,1,1,1,-1,-1,1,-1,1,1,1,1,1,1,
-1,1,-1,-1,-1,1,1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,1]),b.STATIC_DRAW);b.enableVertexAttribArray(e);b.vertexAttribPointer(e,3,b.FLOAT,!1,0,0);b.uniformMatrix4fv(d,!1,g);e=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,e);b.bufferData(b.ARRAY_BUFFER,new Uint8Array([255,0,0,255,0,0,255,0,0,255,0,0,255,0,0,255,0,0,0,0,255,0,0,255,0,0,255,0,0,255,0,0,255,0,0,255,0,255,0,0,255,0,0,255,0,0,255,0,0,255,0,0,255,0]),b.STATIC_DRAW);b.enableVertexAttribArray(m);b.vertexAttribPointer(m,3,b.UNSIGNED_BYTE,!0,0,0);
b.drawArrays(b.TRIANGLES,0,18)})});
