function cross(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function subtractVectors(a,b){return[a[0]-b[0],a[1]-b[1],a[2]-b[2]]}function normalize(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return 1E-5<b?[a[0]/b,a[1]/b,a[2]/b]:[0,0,0]};function makeLookAt(a,b,c){b=normalize(subtractVectors(a,b));c=cross(c,b);var e=cross(b,c);return[c[0],c[1],c[2],0,e[0],e[1],e[2],0,b[0],b[1],b[2],0,a[0],a[1],a[2],1]}function makePerspective(a,b,c,e){a=Math.tan(0.5*Math.PI-0.5*a);var f=1/(c-e);return[a/b,0,0,0,0,a,0,0,0,0,(c+e)*f,-1,0,0,c*e*f*2,0]}function makeTranslation(a,b,c){return[1,0,0,0,0,1,0,0,0,0,1,0,a,b,c,1]}function makeXRotation(a){var b=Math.cos(a);a=Math.sin(a);return[1,0,0,0,0,b,a,0,0,-a,b,0,0,0,0,1]}
function makeYRotation(a){var b=Math.cos(a);a=Math.sin(a);return[b,0,-a,0,0,1,0,0,a,0,b,0,0,0,0,1]}function makeZRotation(a){var b=Math.cos(a);a=Math.sin(a);return[b,a,0,0,-a,b,0,0,0,0,1,0,0,0,0,1]}function makeScale(a,b,c){return[a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1]}
function makeInverse(a){var b=a[0],c=a[1],e=a[2],f=a[3],h=a[4],d=a[5],q=a[6],m=a[7],l=a[8],k=a[9],g=a[10],r=a[11],n=a[12],p=a[13],s=a[14];a=a[15];var t=g*a,u=s*r,v=q*a,w=s*m,x=q*r,y=g*m,z=e*a,A=s*f,B=e*r,C=g*f,D=e*m,E=q*f,F=l*p,G=n*k,H=h*p,I=n*d,J=h*k,K=l*d,L=b*p,M=n*c,N=b*k,O=l*c,P=b*d,Q=h*c,R=t*d+w*k+x*p-(u*d+v*k+y*p),S=u*c+z*k+C*p-(t*c+A*k+B*p),p=v*c+A*d+D*p-(w*c+z*d+E*p),c=y*c+B*d+E*k-(x*c+C*d+D*k),d=1/(b*R+h*S+l*p+n*c);return[d*R,d*S,d*p,d*c,d*(u*h+v*l+y*n-(t*h+w*l+x*n)),d*(t*b+A*l+B*n-(u*b+
z*l+C*n)),d*(w*b+z*h+E*n-(v*b+A*h+D*n)),d*(x*b+C*h+D*l-(y*b+B*h+E*l)),d*(F*m+I*r+J*a-(G*m+H*r+K*a)),d*(G*f+L*r+O*a-(F*f+M*r+N*a)),d*(H*f+M*m+P*a-(I*f+L*m+Q*a)),d*(K*f+N*m+Q*r-(J*f+O*m+P*r)),d*(H*g+K*s+G*q-(J*s+F*q+I*g)),d*(N*s+F*e+M*g-(L*g+O*s+G*e)),d*(L*q+Q*s+I*e-(P*s+H*e+M*q)),d*(P*g+J*e+O*q-(N*q+Q*g+K*e))]}
function matrixMultiply(a,b){return[a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+a[3]*b[12],a[0]*b[1]+a[1]*b[5]+a[2]*b[9]+a[3]*b[13],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]+a[3]*b[14],a[0]*b[3]+a[1]*b[7]+a[2]*b[11]+a[3]*b[15],a[4]*b[0]+a[5]*b[4]+a[6]*b[8]+a[7]*b[12],a[4]*b[1]+a[5]*b[5]+a[6]*b[9]+a[7]*b[13],a[4]*b[2]+a[5]*b[6]+a[6]*b[10]+a[7]*b[14],a[4]*b[3]+a[5]*b[7]+a[6]*b[11]+a[7]*b[15],a[8]*b[0]+a[9]*b[4]+a[10]*b[8]+a[11]*b[12],a[8]*b[1]+a[9]*b[5]+a[10]*b[9]+a[11]*b[13],a[8]*b[2]+a[9]*b[6]+a[10]*b[10]+a[11]*b[14],a[8]*
b[3]+a[9]*b[7]+a[10]*b[11]+a[11]*b[15],a[12]*b[0]+a[13]*b[4]+a[14]*b[8]+a[15]*b[12],a[12]*b[1]+a[13]*b[5]+a[14]*b[9]+a[15]*b[13],a[12]*b[2]+a[13]*b[6]+a[14]*b[10]+a[15]*b[14],a[12]*b[3]+a[13]*b[7]+a[14]*b[11]+a[15]*b[15]]};var error=function(a){window.console&&(window.console.error?window.console.error(a):window.console.log&&window.console.log(a))},loadShader=function(a,b,c,e){e=e||error;c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return a.getShaderParameter(c,a.COMPILE_STATUS)?c:(lastError=a.getShaderInfoLog(c),e("*** Error compiling shader '"+c+"':"+lastError),a.deleteShader(c),null)},createProgram=function(a,b,c,e){for(var f=a.createProgram(),h=0;h<b.length;h++)a.attachShader(f,b[h]);if(c)for(h=0;h<
c.length;h++)a.bindAttribLocation(f,e?e[h]:h,c[h]);a.linkProgram(f);return a.getProgramParameter(f,a.LINK_STATUS)?f:(lastError=a.getProgramInfoLog(f),error("Error in program linking: "+lastError),a.deleteProgram(f),null)};
$(document).ready(function(){function a(){var a=createProgram(c,[e,f]);c.useProgram(a);var d=c.getAttribLocation(a,"a_position"),q=c.getAttribLocation(a,"a_color"),a=c.getUniformLocation(a,"u_matrix"),m=[0,0,0],l=[0*Math.PI/180,0*Math.PI/180,0*Math.PI/180],k=[1,1,1],g=makeScale(k[0],k[1],k[2]),r=makeZRotation(l[2]),k=makeYRotation(l[1]),l=makeXRotation(l[0]),m=makeTranslation(m[0],m[1],m[2]),n=makeLookAt([3,3,3],[0,0,0],[0,1,0]),n=makeInverse(n),p=makePerspective(55*Math.PI/180,b.width/b.height,1,
2E3),g=matrixMultiply(g,r),g=matrixMultiply(g,k),g=matrixMultiply(g,l),g=matrixMultiply(g,m),g=matrixMultiply(g,n),g=matrixMultiply(g,p),k=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,k);c.bufferData(c.ARRAY_BUFFER,new Float32Array([-1,1,1,-1,-1,1,1,-1,1,-1,1,1,1,-1,1,1,1,1,1,1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1]),c.STATIC_DRAW);c.enableVertexAttribArray(d);c.vertexAttribPointer(d,3,c.FLOAT,!1,0,0);c.uniformMatrix4fv(a,!1,g);d=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,
d);c.bufferData(c.ARRAY_BUFFER,new Uint8Array([255,0,0,255,0,0,255,0,0,255,0,0,255,0,0,255,0,0,0,0,255,0,0,255,0,0,255,0,0,255,0,0,255,0,0,255,0,255,0,0,255,0,0,255,0,0,255,0,0,255,0,0,255,0]),c.STATIC_DRAW);c.enableVertexAttribArray(q);c.vertexAttribPointer(q,3,c.UNSIGNED_BYTE,!0,0,0);c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT);c.drawArrays(c.TRIANGLES,0,18)}var b=document.getElementById("canvas"),c=b.getContext("webgl")||b.getContext("experimental-webgl");if(c){c.enable(c.CULL_FACE);c.enable(c.DEPTH_TEST);
var e,f;$.when($.get("/glsl/vertex.glsl",function(a){e=loadShader(c,a,c.VERTEX_SHADER)}),$.get("/glsl/fragment.glsl",function(a){f=loadShader(c,a,c.FRAGMENT_SHADER)})).then(a)}});
