function make2DProjection(a,b){return[2/a,0,0,0,2/b,0,-1,1,1]}function makeTranslation(a,b){return[1,0,0,0,1,0,a,b,1]}function makeRotation(a){var b=Math.cos(a);a=Math.sin(a);return[b,-a,0,a,b,0,0,0,1]}function makeScale(a,b){return[a,0,0,0,b,0,0,0,1]}
function matrixMultiply(a,b){return[a[0]*b[0]+a[1]*b[3]+a[2]*b[6],a[0]*b[1]+a[1]*b[4]+a[2]*b[7],a[0]*b[2]+a[1]*b[5]+a[2]*b[8],a[3]*b[0]+a[4]*b[3]+a[5]*b[6],a[3]*b[1]+a[4]*b[4]+a[5]*b[7],a[3]*b[2]+a[4]*b[5]+a[5]*b[8],a[6]*b[0]+a[7]*b[3]+a[8]*b[6],a[6]*b[1]+a[7]*b[4]+a[8]*b[7],a[6]*b[2]+a[7]*b[5]+a[8]*b[8]]};var error=function(a){window.console&&(window.console.error?window.console.error(a):window.console.log&&window.console.log(a))},loadShader=function(a,b,c,f){f=f||error;c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return a.getShaderParameter(c,a.COMPILE_STATUS)?c:(lastError=a.getShaderInfoLog(c),f("*** Error compiling shader '"+c+"':"+lastError),a.deleteShader(c),null)},createProgram=function(a,b,c,f){for(var d=a.createProgram(),e=0;e<b.length;e++)a.attachShader(d,b[e]);if(c)for(e=0;e<
c.length;e++)a.bindAttribLocation(d,f?f[e]:e,c[e]);a.linkProgram(d);return a.getProgramParameter(d,a.LINK_STATUS)?d:(lastError=a.getProgramInfoLog(d),error("Error in program linking: "+lastError),a.deleteProgram(d),null)};
$(document).ready(function(){var a=document.getElementById("canvas"),b=a.getContext("webgl")||a.getContext("experimental-webgl"),c,f;$.when($.get("/glsl/vertex.glsl",function(a){c=loadShader(b,a,b.VERTEX_SHADER)}),$.get("/glsl/fragment.glsl",function(a){f=loadShader(b,a,b.FRAGMENT_SHADER)})).then(function(){var d=createProgram(b,[c,f]);b.useProgram(d);var e=b.getAttribLocation(d,"a_position"),k=b.getUniformLocation(d,"u_matrix"),d=b.getUniformLocation(d,"u_color"),h=0*Math.PI/180,g=makeScale(1,1),
l=makeRotation(h),h=makeTranslation(0,0),m=make2DProjection(a.width,a.height),g=matrixMultiply(g,l),g=matrixMultiply(g,h),g=matrixMultiply(g,m),h=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,h);b.bufferData(b.ARRAY_BUFFER,new Float32Array([0,0,0,-a.height,a.width,-a.height]),b.STATIC_DRAW);b.enableVertexAttribArray(e);b.vertexAttribPointer(e,2,b.FLOAT,!1,0,0);b.uniformMatrix3fv(k,!1,g);b.uniform3f(d,0,0,0);b.drawArrays(b.TRIANGLES,0,3)})});
